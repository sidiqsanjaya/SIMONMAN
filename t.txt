nft delete table inet filter
nft add table inet filter
nft add set inet filter allowed_ips { type ipv4_addr \; }

# Tambahkan IP yang diizinkan ke dalam set
nft add element inet filter allowed_ips { 192.168.1.1, 192.168.10.1, 202.51.122.150 }

# Buat tabel dan chain

nft add chain inet filter input { type filter hook input priority 0 \; }
nft add chain inet filter forward { type filter hook forward priority 0 \; }

# Blokir lalu lintas dari br-lan dengan sumber IP 192.168.1.0/24

nft add rule inet filter input ip saddr @allowed_ips counter accept
nft add rule inet filter forward ip saddr @allowed_ips counter  accept

nft add rule inet filter input iifname "br-lan" ip saddr 192.168.1.0/24 counter drop
nft add rule inet filter input iifname "br-lan" ip saddr 192.168.1.0/24 counter reject


nft list ruleset
